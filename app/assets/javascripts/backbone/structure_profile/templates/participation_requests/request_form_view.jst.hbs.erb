<div class="panel__header soft-half--ends soft--sides">
    <h5 class="flush">
      Envoyer une demande de :
    </h5>
</div>
<div class="panel__body soft">
  <div class="text--center push-half--bottom">
    <label class="orange btn-as-link f-weight-bold inline-block epsilon" data-behavior="toggle-type" data-type="booking" for="request_type_booking">
      Réservation
      <input type="radio" value="booking" class="hidden" name="request_type" checked id="request_type_booking">
    </label>
    |
    <label class="orange btn-as-link inline-block epsilon" data-behavior="toggle-type" data-type="information" for="request_type_information">
      Information
      <input type="radio" value="information" class="hidden" name="request_type" id="request_type_information">
    </label>
  </div>
    {{#if participation_request.user.last_message_sent}}
        <div class="green"><i class="fa fa-check"></i> <strong>Dernier message envoyé le {{participation_request.user.last_message_sent}}</strong></div>
        <hr class="push--ends">
    {{/if}}
    <article class="tab-pane active hard">
        <form action="{{participation_request.url}}">
            <div class="grid--full">
            <div class="soft-half--bottom" data-type="booking-request-type-wrapper">
                <select name="course_id" class="input--large one-whole" >
                    <option>Quel cours vous intéresse ?</option>
                    {{#if structure.courses}}
                        <optgroup label="Cours réguliers">
                            {{#each structure.courses}}
                                <option data-collection-type="courses" value="{{this.id}}" {{#ifIncludeString ../course_ids this.id}}selected{{/ifIncludeString}}>{{this.name}}</option>
                            {{/each}}
                        </optgroup>
                    {{/if}}
                    {{#if structure.trainings}}
                        <optgroup label="Stages & Ateliers">
                          {{#each structure.trainings}}
                              <option data-collection-type="trainings" value="{{this.id}}" {{#ifIncludeString ../course_ids this.id}}selected{{/ifIncludeString}}>{{this.name}}</option>
                          {{/each}}
                        </optgroup>
                    {{/if}}
                </select>
                {{#if errors.course_id}}
                    <div class="input_field_error red f-weight-bold text--right">{{errors.course_id}}</div>
                {{/if}}
                <div class="soft-half--top" data-element="planning-select-wrapper" style="display: none">
                    <select name="planning_id" class="input--large one-whole">
                        <option>Quelle séance souhaitez-vous ?</option>
                    </select>
                </div>
                {{#if participation_request.planning_id}}{{#if errors.planning_id}}
                    <div class="input_field_error red f-weight-bold text--right">{{errors.planning_id}}</div>
                {{/if}}{{/if}}
                <div class="text--center flexbox soft-half--top" data-element="datepicker-wrapper" style="display: none">
                  <label class="label--large nowrap flexbox__item soft-half--right one-twelfth" for="request-date">Votre jour : </label>
                  <div class="flexbox__item text--left">
                    <input type="text" data-behavior="datepicker" name="date" id="request-date" class="datepicker-input input--large">
                  </div>
                  <div class="flexbox__item text--left nowrap">
                    <div data-element="time-wrapper">
                      <select class="input--large" name="start-hour" data-element="start-hour-select"></select>
                      <label class="label--large inline-block">h</label>
                      <select class="input--large" name="start-min" data-element="start-minute-select">
                        <option value="00">00</option>
                        <option value="15">15</option>
                        <option value="30">30</option>
                        <option value="45">45</option>
                      </select>
                    </div>
                  </div>
                </div>
            </div>
            <div class="one-whole v-middle push-half--bottom" class="one-whole">
                <div class="input-addon">
                    <div class="input-prefix">
                        <i class="fa fa-phone-o"></i>
                    </div>
                    <input type="text" class="input--large one-whole hard--right" name='user[phone_number]' type='text' placeholder='Votre téléphone (confidentiel)' value="{{#if user.phone_number}}{{ user.phone_number }}{{/if}}" data-toggle="popover" data-content="Nous vous recommandons de laisser votre numéro de portable : si la séance est annulée ou modifiée, un SMS pourra vous être envoyé." data-trigger="hover" data-placement="left">
                </div>
                {{#if errors.user.phone_number}}
                    <div class="input_field_error red f-weight-bold text--right">{{errors.user.phone_number}}</div>
                {{/if}}
            </div>
            <div class="input flush--top push-half--bottom">
                <textarea name="message[body]" id="" cols="30" rows="12" class="one-whole input--large" style='height: 185px;' data-behavior='autoresize'>{{#unless errors.body}}{{ participation_request.message.body }}{{/unless}}</textarea>
            </div>
            {{#if errors.body}}
                <div class="input_field_error red f-weight-bold text--right">{{errors.body}}</div>
            {{/if}}
            <button type="submit" class="btn btn--green btn--full" data-disable-with="Message en cours d'envoi...">
                Envoyer ma demande de réservation
            </button>
        </form>
        <div class="hidden" data-type="information-request-type-wrapper">
            <hr>
            {{#if structure.phone_numbers}}
                <a href="javascript:void(0)" class="btn btn--green btn--full" data-behavior="show-phone-numbers" data-action="log-action" data-action-info="telephone">
                    <i class="fa fa-phone v-middle"></i>
                    <span class="v-middle">Téléphone</span>
                </a>
                <div class="phone_number hidden">
                    <div class="soft--top text--center">
                        {{#each structure.phone_numbers}}
                            {{#ifCond @index '>' 0}}<br>{{/ifCond}}
                            <strong class="epsilon v-middle" itemprop="telephone">{{this}}</strong>
                            {{#if structure.premium }}
                                <i class="soft-half--left v-middle fa fa-check-circle green"></i>
                                <i class="v-middle green milli">vérifié</i>
                            {{/if}}
                        {{/each}}
                    </div>
                </div>
            {{/if}}

            {{#if structure.premium }}{{#if structure.website }}
              <a href="{{ structure.website }}" class="btn btn--green btn--full push-half--top" target="_blank" data-action="log-action" data-action-info="website">
                <i class="fa fa-globe v-middle"></i> <span class="v-middle">Site internet</span>
              </a>
            {{/if}}{{/if}}
        </div>
    </article>
</div>

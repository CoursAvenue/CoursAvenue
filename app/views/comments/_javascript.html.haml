= content_for :scripts do
  :javascript
    $(function() {
        var star;
        var rating_descriptions = [
          'Épouvantable',
          "Mauvais",
          'Moyen',
          'Très bon',
          "Excellent !"
        ]
        // Add events on stars
        $('.rating .star').click(function() {
            $('#comment_rating').val($(this).data('value'));
            $('#comment_rating').trigger('change');
            $(this).prevAll().addClass('icon-star').removeClass('icon-star-empty');
            $(this).addClass('icon-star').removeClass('icon-star-empty');
            $(this).nextAll().removeClass('icon-star').addClass('icon-star-empty');
        });
        if ($('#new-comment')) {
            $('#new-comment').submit(function(){
                if ($('#comment_rating').val().length === 0) {
                    GLOBAL.flash('Vous devez mettre une note pour poster un avis.');
                    return false;
                }
            });
        }
        // Add animation on stars
        $('.rating .star').hover(
            function() {
                $('#rating-description').text(rating_descriptions[parseInt($(this).data('value')) - 1]);
                if ($('#comment_rating').val().length === 0 || (parseInt($('#comment_rating').val()) < parseInt($(this).data('value')))) {
                    $(this).prevAll().addClass('icon-star').removeClass('icon-star-empty');
                    $(this).addClass('icon-star').removeClass('icon-star-empty');
                    $(this).nextAll().removeClass('icon-star').addClass('icon-star-empty');
                }
            },
            function() {
                $('.rating .star').removeClass('icon-star').addClass('icon-star-empty');
                if ($('#comment_rating').val().length > 0) {
                    var value = parseInt($('#comment_rating').val());
                    $('#rating-description').text(rating_descriptions[value - 1]);
                    for (var i = 0; i < value; i += 1) {
                        $($('.rating .star')[i]).addClass('icon-star').removeClass('icon-star-empty');
                    }
                } else {
                    $('#rating-description').text('');
                }
            }
        );
        // Initialization
        if ((star = $('.rating .star[data-value=' + $('#comment_rating').val() + ']')).length > 0) {
            star[0].click();
        }
        if ($('#comment_rating').val().length > 0 || $('#comment_content').val().length > 0) {
            scrollTo(0, $('#comments').offsetTop);
        }
    });

- params[:types]       ||= ['lesson', 'training', 'workshop']
- params[:audiences]   ||= [] # Audience.all.collect(&:id).map(&:to_s)
- params[:levels]      ||= [] # Level.all.collect(&:id).map(&:to_s)
- params[:week_days]   ||= [] # LeBonCours::Application::WEEK_DAYS
- params[:time_slots]  ||= [] # LeBonCours::Application::TIME_SLOTS
- params[:price_range] ||= {} # {min: 0, max: 1000}
- params[:time_range]  ||= {}
- params[:zip_codes]   ||= [] # (75001..75020).to_a.map(&:to_s)

%section.gw
  = form_tag course_groups_path, class: 'g one-whole', method: :get, authenticity_token: false do
    .one-whole.header-search-bar
      %div
        %input.search-input{placeholder: 'Danse, Cuisine, ...', type: 'search', name: 'name', value: params[:name]}
        %ul.search-list.milli
          %li
            = check_box_tag 'types[]', 'lesson', params[:types].include?('lesson'), id: "search_lesson_course_type"
            = label_tag 'search_lesson_course_type', 'Cours r√©current'
          %li
            = check_box_tag 'types[]', 'workshop', params[:types].include?('workshop'), id: "search_workshop_course_type"
            = label_tag 'search_workshop_course_type', 'Atelier ponctuel'
          %li
            = check_box_tag 'types[]', 'training', params[:types].include?('training'), id: "search_training_course_type"
            = label_tag 'search_training_course_type', 'Stage'
      .milli
        .one-whole
          %ul.nav.inline-checkboxes
            - LeBonCours::Application::WEEK_DAYS.each_with_index do |week_day, i|
              %li
                = check_box_tag 'week_days[]', week_day, params[:week_days].include?(week_day), id: "search_week_day_#{week_day.downcase}"
                = label_tag "search_week_day_#{week_day.downcase}", week_day
            %li
              = check_box_tag '', '', params[:week_days].empty?, id: "search_week_days_all"
              = label_tag "search_week_days_all", 'Tous'
        %div.flexbox
          %ul.nav.inline-checkboxes.flexbox__item
            - LeBonCours::Application::TIME_SLOTS.each do |slot_symbole, slot|
              %li.time-slot
                = check_box_tag 'time_slots[]', slot_symbole, params[:time_slots].include?(slot_symbole.to_s), id: "search_time_slot_#{slot_symbole.to_s}"
                = label_tag "search_time_slot_#{slot_symbole.to_s}", slot[:name].html_safe
            %li.time-slot
              = check_box_tag '', '', params[:time_slots].empty?, id: "search_time_slot_all"
              = label_tag "search_time_slot_all", 'Tous'
          %div.flexbox__item
            Du
            %input.milli.datepicker-input{value: l(Date.today), name: 'start_date', data: {behavior: 'datepicker'}}
            au
            %input.milli.datepicker-input{value: l(Date.today + 6.months), name: 'end_date', data: {behavior: 'datepicker'}}
      %div
        %button.btn{type: 'submit', id: 'submit_search_form'}
          %i.icon-search
          Chercher

    .accessibility
      - @audiences.each_with_index do |audience, i|
        = check_box_tag 'audiences[]', audience.id, params[:audiences].include?(audience.id.to_s), id: "hidden_search_audience_#{i}"
      - @levels.each_with_index do |level, i|
        = check_box_tag 'levels[]', level.id, params[:levels].include?(level.id.to_s), id: "hidden_search_level_#{level.name}"
      = number_field_tag 'price_range[min]', params[:price_range][:min], min: 0, step: 1, id: 'hidden_search_price_range_min'
      = number_field_tag 'price_range[max]', params[:price_range][:max], min: 0, step: 1, id: 'hidden_search_price_range_max'

      - (75001..75020).to_a.map(&:to_s).each do |zip_code|
        = check_box_tag 'zip_codes[]', zip_code, params[:zip_codes].include?(zip_code), id: "hidden_search_arrondissement_#{zip_code}"
      %input{name: 'time_range[min]', value: params[:time_range][:min], id: 'hidden_start_time'}
      %input{name: 'time_range[max]', value: params[:time_range][:max], id: 'hidden_end_time'}}

      / = check_box_tag 'types[]', 'lesson', params[:types].include?('lesson'), id: "hidden_search_lesson_course_type"
      / = check_box_tag 'types[]', 'training', params[:types].include?('training'), id: "hidden_search_training_course_type"
      / = check_box_tag 'types[]', 'workshop', params[:types].include?('workshop'), id: "hidden_search_workshop_course_type"

.panel
  .panel__header.soft
    %h4.flush Connexion Ã  votre espace pro
  .panel__body.soft
    .text--center
      %a{ data: { behavior: 'facebook-login', disable_with: 'Connexion en cours...' }, class: 'btn btn--facebook', id: 'facebook_button' }
        Connexion avec Facebook
    .or
      %span.f-weight-600
        ou

    = simple_form_for(Admin.new, as: :pro_admin, url: pro_admin_session_url(subdomain: CoursAvenue::Application::PRO_SUBDOMAIN)) do |f|
      .form-inputs
        .input-addon.push-half--bottom
          .input-prefix.epsilon @
          = f.input :email, required: false, autofocus: true, input_html: { class: 'one-whole input--large', placeholder: 'E-mail' }, label: false
        .input-addon.push-half--bottom
          .input-prefix.epsilon
            .fa.fa-lock
          = f.input :password, required: false, input_html: { class: 'one-whole input--large', placeholder: 'Mot de passe' }, label: false
        = f.input :remember_me, as: :hidden, input_html: { value: true }

      = f.button :submit, "Se connecter", class: 'btn--green btn--full', data: { disable_with: 'Connexion en cours...' }
      .push-half--top
        = render "pro/admins/shared/links"

:javascript
  $('[data-behavior=facebook-login]').click(function() {
    var loginOptions = {
          callbackRoute: Routes.pro_auth_facebook_callback_path(),
          success: function success (response) {
              window.location = response.redirect_url
          },
          error: function error (response) {
              var message = $.parseJSON(response.responseText).message;
              GLOBAL.flash(message);
          },
          pro: true
      };

      CoursAvenue.loginWithFacebook(loginOptions);
  });

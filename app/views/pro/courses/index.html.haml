= side_menu_currently_at 'Mes cours'

- if @courses.any?
  %table.table--striped.dataTable.table--data.white-box.flush--bottom
    %thead
      %tr
        %th.text--center.one-twelfth Statut
        %th{style: 'width: 14%'}
          %span Type
        %th.sortDesc.two-twelfths
          %span Nom
        %th.four-twelfths
        %th{style: 'width: 12%'}
    %tbody
      - @courses.each do |course|
        %tr
          %td.text--center
            - if course.active
              = link_to disable_pro_course_path(course), method: :put, class: 'switch-button on', title: 'Enlever le cours de CoursAvenue' do
                Visible
            - else
              = link_to activate_pro_course_path(course), method: :put, class: 'switch-button off', title: 'Afficher le cours sur CoursAvenue'  do
                Non&nbsp;visible
          %td= course.type_name
          %td
            - if (course.is_lesson? and course.end_date.nil?) or (course.end_date and course.end_date < Date.today)
              .warning-buble{data: {behavior: 'tooltip', 'original-title' => 'Les dates renseignées pour se cours sont passées.'}}
                !
            = link_to course.name, edit_pro_course_path(course)
          %td.text--right
            .btn-group
              - if course.image.present?
                = image_tag course.image.url(:mini), height: 30, class: 'v-middle'
              - else
                .btn>
                  = link_to edit_pro_course_path(course) do
                    %i.icon-picture
                    Photo
                    %i.icon-remove.red
              .btn>
                = link_to pro_course_prices_path(course) do
                  € Tarifs
                  - if course.prices.empty?
                    %i.icon-remove.red
                  - else
                    %i.icon-ok.green
              .btn>
                = link_to pro_course_plannings_path(course) do
                  %i.lbc-icon-calendar
                  %span Plannings
                  - if course.plannings.empty?
                    %i.icon-remove.red
                  - else
                    %i.icon-ok.green
          %td.text--center.hard
            .drop-down-el.drop-down__wrapper{data: {behavior: 'drop-down', el: '> .drop-down__el', position: 'right'}}
              %a.btn{href: '#'}
                Actions
                %i.icon-chevron-down
                / Actions
              %ul.drop-down__el.text--left
                %li
                  = link_to edit_pro_course_path(course), title: 'Modifier ce cours', class: 'nowrap' do
                    %i.icon-pencil
                    Modifier le cours
                %li
                  = link_to duplicate_pro_course_path(course), title: 'Modifier ce cours', class: 'nowrap', method: :post do
                    %i.icon-copy
                    Dupliquer le cours
                %li
                  = link_to  course_url(course, subdomain: 'www'), title: 'Voir le cours sur CoursAvenue', target: '_blank', class: 'nowrap' do
                    %i.icon-search
                    Voir sur CoursAvenue
                %li
                  = link_to pro_course_path(course), method: :delete, class: 'red nowrap', title: 'Supprimer ce cours', data: {confirm: 'Êtes-vous sur de supprimer ce cours ? Cette action sera irreversible.'} do
                    %i.icon-trash
                    Supprimer
  - if @courses.disabled.any?
    .grid.push-half--top
      .grid__item.one-half>
        .soft--left.push--left= image_tag 'texts/online-course.png', height: 80
      .grid__item.one-half>
        .soft--right.push--right= image_tag 'texts/plannings.png', height: 62
.text--center.push--top
  = link_to 'Ajouter un cours', new_pro_structure_course_path(@structure), class: 'btn btn--success btn--large'

= content_for :scripts do
  :javascript
    $(function() {
        $('.dataTable').each(function(datatable, i) {
            datatable.set('id', 'datatable_' + i)
            $('#datatable_' + i).tablesorter();
        })
        if ($('#understood__course_status')) {
            $('#understood__course_status').click(function() {
                $.cookie('understood__course_status', true, {expires: 10000});
                $('#course-status-info').remove();
            })
        }
    });

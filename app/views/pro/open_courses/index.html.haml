= side_menu_currently_at 'JPO'

.text--center
  .inline-block.one-quarter.push--bottom.v-middle.push--sides
    .white-box.soft-half.text--center
      %h3.flush= "#{Course::Open.count} atelier JPOs"
      %h6.flush dont #{Course::Open.where{created_at > Date.today}.count} aujourd'hui
      %div et #{Course::Open.where{created_at > Date.today - 7.days}.count} les 7 derniers jours

  .inline-block.one-quarter.push--bottom.v-middle.push--sides
    .white-box.soft-half.text--center
      %h3.flush
        = Course::Open.all.map{|course| course.nb_participants_max * course.plannings.count}.reduce(&:+)
        places


%table.table--striped.dataTable.table--data.white-box.flush--bottom
  %thead
    %tr
      %th Nom de l'établissement
      %th Nom du cours
      %th Type
      %th Discipline
      %th.text--center # créneaux
      %th.text--center # places dispos
      %th Prix
  %tbody
    - @courses.each do |course|
      %tr
        %td= link_to course.structure.name, pro_structure_course_opens_path(course.structure)
        %td= course.name
        %td= course.event_type
        %td= course.subjects.map(&:name).join(',')
        %td.text--center= course.plannings.count
        %td.text--center= course.nb_participants_max * course.plannings.count
        %td
          - if course.free?
            Gratuit
          - else
            = "#{readable_amount(course.price)}€"

= side_menu_currently_at 'Profil'
%ol.nav.breadcrumb.alpha.header-group.header-group
  %li= link_to 'Tous mes cours', pro_structure_path(@structure)
  %li= link_to @course.name, edit_pro_course_path(@course)
  %li Planning

%ul.tabs.push--top
  %li
    = link_to edit_pro_course_path(@course) do
      %i.lbc-icon-info i
      Info
  %li
    = link_to pro_course_prices_path(@course) do
      € Tarif
  %li.active
    %a
      %i.icon-calendar
      Planning

%h3 Planning du cours
- if @plannings.any?
  %h5 Séances à venir
= render "#{@course.underscore_name}_list"
%hr

%h5.form-header-group.flush--bottom
  - if action_name == 'edit'
    %i.icon-pencil
    Édition d'un créneau
  - else
    Rajouter un créneau
.form-white-box
  = render "#{@course.underscore_name}_form"

= content_for :scripts do
  :javascript
    $(function() {
        $('#add-teacher').click(function(event) {
            $('#add-teacher-wrapper').hide();
            $('#new-teacher-wrapper').show();
        });
        if ($('#show-past-planning')) {
            $('#show-past-planning').click(function() {
                $(this).remove();
                $('#past-planning').removeClass('hidden');
            });
        }
        if ($('.teacher-select').length > 0) {
            $('.teacher-select').each(function(index, teacher_select){
                $(this).change(function() {
                    teacher_form = $(this).parents('form')
                    teacher_form.submit();
                    GLOBAL.flash('Le professeur a bien été changé.')
                })
            });
        }
        if ($('.place-select').length > 0) {
            $('.place-select').each(function(index, place_select){
                $(this).change(function() {
                    planning_form = $(this).parents('form')
                    planning_form.submit();
                    GLOBAL.flash('Le lieu a bien été changé.')
                })
            });
        }
        if ($('[name="planning[audience_ids][]"]').length > 0) {
            $('[name="planning[audience_ids][]"]').change(function(event) {
                if (event.target.value == '1') {
                    if (event.target.checked) {
                        $('#children-ages').removeClass('hidden');
                    } else {
                        $('#children-ages').addClass('hidden');
                    }
                }
            });
        }
    });

= side_menu_currently_at 'courses'

.panel
  .panel__body.soft--ends
    .soft--sides
      %h4 Ajouter un :
      .grid
        .grid__item.one-half>
          = link_to 'Cours collectif', new_pro_structure_course_path(@structure, type: 'Course::Lesson'), class: 'btn btn--green btn--full fancybox.ajax', data: { behavior: 'modal', width: '700', padding: '0', close_click: 'false' }
        .grid__item.one-half>
          = link_to 'Stage / Atelier', new_pro_structure_course_path(@structure, type: 'Course::Training'), class: 'btn btn--green btn--full fancybox.ajax', data: { behavior: 'modal', width: '700', padding: '0', close_click: 'false' }

    %hr.push--ends
    .soft--sides
      %h5 Cours collectifs
      - @courses.lessons.each do |course|
        = simple_form_for [:pro, @structure, course], url: pro_structure_course_path(@structure, course), as: :course, remote: true, html: { data: { behavior: 'live-form' } } do |f|
          .float--right
            .nowrap
              %label.inline-block.v-middle Tarifs appliqués :
              = f.input :price_group_id, as: :select, collection: @structure.price_groups, label: false, input_html: { style: 'max-width: 15em;' }, wrapper_html: {  class: 'flush v-middle inline-block' }, include_blank: false

          .push-half--bottom
            %h5.flush.inline-block.v-middle= course.name
            = link_to edit_pro_structure_course_path(@structure, course), class: 'push-half--left v-middle fancybox.ajax nowrap', data: { behavior: 'modal', width: '700', padding: '0' } do
              %i.fa.fa-pencil
              Modifier
            %span.v-middle /
            = link_to ask_for_deletion_pro_structure_course_path(@structure, course), class: 'v-middle red fancybox.ajax nowrap', data: { behavior: 'modal', width: '400', padding: '0' } do
              %i.fa.fa-trash-o
              Supprimer
          = f.input :frequency, as: :select, collection: Course::COURSE_FREQUENCIES, label_method: lambda {|course_frequency| t(course_frequency)}, default: Course::COURSE_FREQUENCIES.first, label: false, wrapper_html: { class: 'flush inline-block v-middle' }
          %span.soft-half--sides.v-middle> du
          .inline-block.v-middle{ data: { behavior: 'date-range', 'start-date' => '#course_start_date', 'end-date' => '#course_end_date' } }>
            = f.input :start_date, as: :string, label: false, input_html: { value: l(course.start_date), style: 'margin-right: 5px', class: 'datepicker-input datepicker-input--small', data: { behavior: 'datepicker' } }, wrapper_html: { class: 'flush inline-block v-middle' }
            %span.soft-half--sides.v-middle> au
            = f.input :end_date, as: :string, label: false, input_html: { value: l(course.start_date), class: 'datepicker-input datepicker-input--small', data: { behavior: 'datepicker' } }, wrapper_html: { class: 'flush inline-block v-middle' }
          -# (pas de cours pendant les vacances, pas d'inscription en cours d'année)
        .push-half--top
          = render partial: 'pro/structures/courses/plannings/lesson_list', locals: { course: course, structure: @structure }
        = link_to 'Ajouter un créneau', new_pro_structure_course_planning_path(@structure, course), class: 'btn btn--green btn--small fancybox.ajax nowrap', data: { behavior: 'modal', width: '800', padding: '0' }
        %hr


      %hr.push--ends
      .soft--sides
        %h5 Stages & Ateliers
      - @courses.trainings.each do |course|
        = simple_form_for [:pro, @structure, course], url: pro_structure_course_path(@structure, course), as: :course, remote: true, html: { data: { behavior: 'live-form' } } do |f|
          .float--right
            .nowrap
              %label.inline-block.v-middle Tarifs appliqués :
              = f.input :price_group_id, as: :select, collection: @structure.price_groups, label: false, input_html: { style: 'max-width: 15em;' }, wrapper_html: {  class: 'flush v-middle inline-block' }, include_blank: false
          .push-half--bottom
            %h5.flush.inline-block.v-middle= course.name
            = link_to edit_pro_structure_course_path(@structure, course), class: 'push-half--left v-middle fancybox.ajax nowrap', data: { behavior: 'modal', width: '700', padding: '0' } do
              %i.fa.fa-pencil
              Modifier
            %span.v-middle /
            = link_to ask_for_deletion_pro_structure_course_path(@structure, course), class: 'v-middle red fancybox.ajax nowrap', data: { behavior: 'modal', width: '400', padding: '0' } do
              %i.fa.fa-trash-o
              Supprimer
        .push-half--top
          = render partial: 'pro/structures/courses/plannings/training_list', locals: { course: course, structure: @structure }
        = link_to 'Ajouter un créneau', new_pro_structure_course_planning_path(@structure, course), class: 'btn btn--green btn--small fancybox.ajax nowrap', data: { behavior: 'modal', width: '800', padding: '0' }
        %hr

= side_menu_currently_at 'Structures'

%table.table--striped.table--data#dataTable
  %thead
    %tr
      %th
        %span Nom
      %th
        %span Nombre de cours
      %th.sortAsc
        %span Date de création
      %th
  %tbody
    - @structures.each do |structure|
      %tr
        %td
          = link_to structure.name, dashboard_pro_structure_path(structure)
          - if structure.main_contact
            \/
            = link_to "(#{structure.main_contact.name})", edit_pro_admin_path(structure.main_contact)
        %td= structure.courses.count
        %td{data: {value: structure.created_at}}
          = l(structure.created_at)
        %td.text--right
          - if structure.active
            = link_to 'Actif', disable_pro_structure_path(structure), method: :put, class: 'switch-button on', title: 'Désactiver'
          - else
            = link_to 'Inactif',  activate_pro_structure_path(structure), method: :put, class: 'switch-button off', title: 'Activer'
          = link_to pro_structure_path(structure), method: :delete, class: 'btn btn--danger', title: 'Supprimer' do
            %i.icon-trash

= content_for :scripts do
  :javascript
    $(function() {
        new TableSorter('dataTable', { columnDataTypes: 'string,int,date,string', cookieName: 'tableSortState__structure_index', dateParseFunction: GLOBAL.DataTable.dateParseFunction});
    });

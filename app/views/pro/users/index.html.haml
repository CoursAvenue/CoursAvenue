= side_menu_currently_at 'Users'

#users

%h2 Liste des utilisateurs (#{@users.length})

%table.table--striped.white-box#dataTable
  %thead
    %tr
      %th
      %th
        %span Nom
      %th
        %span Date d'inscription
      %th
        %span Derni√®re date de connexion
      %th.text--center
        %span Facebook
  %tbody
    - @users.each do |user|
      %tr
        %td.text--center
          - if user and user.has_avatar?
            = image_tag user.avatar_url(:small), height: 30
          - else
            .profile-picture.center-block{class: "profile-picture-variation-#{((user.full_name.length * 16) % 14) + 1}"}
              = user.full_name[0].capitalize
        %td
          = user.full_name
          = link_to "(#{user.email})", "mailto:#{user.email}"
        %td{data: {value: user.created_at}}
          = l(user.created_at, format: :date_short)
        %td{data: {value: user.last_sign_in_at}}
          = l(user.last_sign_in_at) if user.last_sign_in_at
        %td.text--center{data: {value: (user.provider == 'facebook' ? 'f' : '')}}
          - if user.provider == 'facebook'
            %i.icon-ok

= content_for :scripts do
  :javascript
    $(function() {
        $('#dataTable').tablesorter();
        new Highcharts.Chart({
            chart: { renderTo: 'users' },
            title: { text: null },
            xAxis: { categories: #{@users_signups.map{|date, count| l(Date.parse(date), format: :short)}} },
            yAxis: { title: { text: ''}},
            series: [{ data: #{@users_signups.map{|date, count| count}} }]
        });

    });

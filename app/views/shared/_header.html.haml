%header.header
  .main-container.grid--full
    .grid__item.one-third.palm--one-half>
      = link_to root_path, class: 'logo' do
        = image_tag 'logo.png', width: 200, alt: 'Tous les cours et stages autour de vous | CoursAvenue.com'
    %nav.text--right.grid__item.two-thirds.visuallyhidden--palm
      - if current_user
        #drop-down-el.drop-down__wrapper.grid__item.width-auto.v-middle.hard--left{data: {behavior: 'drop-down', el: '> .drop-down__el', position: 'right'}}
          - if current_user.image
            .grid
              .grid__item.v-middle.width-auto>
                %b= current_user.full_name
              .grid__item.v-middle.width-auto.soft-half--left
                = image_tag current_user.image, height: 40, class: 'image'
          - else
            = current_user.full_name
          %ul.drop-down__el
            %li.nowrap
              = link_to destroy_user_session_path, method: :delete do
                Se déconnecter
      - else
        %span
          = link_to "Se connecter", '#', data: {behavior: 'modal', title: 'Connexion', width: '400px', url: '/users/sign_in'}
        %span.soft-half--left.push--right.soft--right.bordered--right
          = link_to "Créer un compte", '#', data: {behavior: 'modal', title: 'Connexion', width: '400px', url: '/users/sign_up'}, class: 'btn btn--success', onclick: "_gaq.push(['_trackEvent', 'Se créer un compte', 'click','Inscrit'])"
        %span
          = link_to 'Espace pro', 'http://pro.coursavenue.com', class: 'btn btn--blue', onclick: "_gaq.push(['_trackEvent', 'Référencer mes cours', 'click','Inscrit'])"

%nav.milli.main-container.soft-half.hard--left.hard--right.visuallyhidden--palm.visuallyhidden--lap
  #star-subjects
    %ul.nav--fit.flush
      - Subject.best_roots.order(:name).each do |subject|
        %li.text--center.drop-down__wrapper{class: (params[:subject_id] == subject.slug ? 'active' : ''), onclick: "_gaq.push(['_trackEvent', 'Header disciplines', 'click', '#{subject.name}']);", data: {behavior: 'drop-down', el: "> .drop-down__el", position: 'center'}}
          = link_to subject.name, subject_places_path(subject, address_name: params[:address_name], lat: params[:lat], lng: params[:lng]), class: 'selected subject-link'
          %ul.drop-down__el
            - subject.children.order('name ASC').each do |child_subject|
              %li{onclick: "_gaq.push(['_trackEvent', 'Header disciplines', 'click', '#{subject.name}', '#{child_subject.name}'])"}= link_to child_subject.name, subject_courses_path(child_subject, address_name: params[:address_name], lat: params[:lat], lng: params[:lng]), class: (params[:subject_id] == child_subject.slug ? 'selected subject-link' : 'subject-link')
      %li.text--center.drop-down__wrapper
        = link_to 'javascript:void(0)', class: 'selected subject-link', id: 'toggle-non-stars' do
          %i.icon-plus
          Plus
  #non-star-subjects{style: 'display: none;'}
    %ul.nav--fit.flush
      - Subject.non_best_roots.order(:name).each do |subject|
        %li.text--center.drop-down__wrapper{class: (params[:subject_id] == subject.slug ? 'active' : ''), onclick: "_gaq.push(['_trackEvent', 'Header disciplines', 'click', '#{subject.name}']);", data: {behavior: 'drop-down', el: "> .drop-down__el", position: 'center'}}
          = link_to subject.name, subject_places_path(subject, address_name: params[:address_name], lat: params[:lat], lng: params[:lng]), class: 'selected subject-link'
          %ul.drop-down__el
            - subject.children.order('name ASC').each do |child_subject|
              %li{onclick: "_gaq.push(['_trackEvent', 'Header disciplines', 'click', '#{subject.name}', '#{child_subject.name}'])"}= link_to child_subject.name, subject_courses_path(child_subject, address_name: params[:address_name], lat: params[:lat], lng: params[:lng]), class: (params[:subject_id] == child_subject.slug ? 'selected subject-link' : 'subject-link')
      %li.text--center.drop-down__wrapper
        = link_to 'javascript:void(0)', class: 'selected subject-link', id: 'toggle-stars' do
          %i.icon-plus
          Plus

= content_for :scripts do
  :javascript
    // ---------------- Comments slideshow
    window.addEvent('domready', function() {
      $('toggle-non-stars').addEvent('click', function() {
          $('star-subjects').dissolve();
          $('non-star-subjects').reveal()
          $$('#non-star-subjects [data-behavior=drop-down]').map(function(drop_down_el){
              drop_down_el.drop_down.setPositionning();
          });
      });
      $('toggle-stars').addEvent('click', function() {
          $('non-star-subjects').dissolve();
          $('star-subjects').reveal();
      });
    });

<div id='fb-root'></div>
<script src='http://connect.facebook.net/en_US/all.js'></script>

%h2
  Aidez votre professeur, parlez-en sur Facebook
  = link_to 'Partager sur Facebook', '#', class: 'btn btn--facebook btn--small', onclick: 'postToFeed(); return false;', id: 'post-facebook'

.grid
  .grid__item.v-bottom.one-half.soft--left>
    = link_to new_user_registration_path, onclick: "mixpanel.track('Signup after comment');", data: {behavior: 'modal', title: "Rejoignez notre communauté d'élèves !"}, class: 'fancybox.ajax', style: 'margin-left: 8em' do
      = image_tag 'texts/want_your_avatar.png', width: 400
  .grid__item.v-bottom.text--right.one-half.soft-half--bottom>
    - unless current_user
      = link_to new_user_registration_path, onclick: "mixpanel.track('Signup after comment');", data: {behavior: 'modal', title: "Rejoignez notre communauté d'élèves !"}, class: 'fancybox.ajax btn btn--orange btn--small' do
        %i.fa.fa-pencil
        Modifier mon avis
%ul.no-bullet-list
  = render partial: 'comments/comment', locals: { comment: @comment }

.text--center.push
  = link_to "Accéder à CoursAvenue", root_url(subdomain: 'www'), onclick: "mixpanel.track('See profile after comment')", class: 'btn btn--blue btn--large'


= content_for :scripts do
  :javascript
    FB.init({appId: "589759807705512", status: true, cookie: true});
    function postToFeed() {
        var obj = {
            method: 'feed',
            redirect_uri: "#{request.protocol + request.host_with_port + request.fullpath}",
            link: "#{structure_url(@structure)}",
            picture: "#{@logo_url || asset_url('logo.png')}",
            name: "Je viens de donner mon avis sur #{@structure.name}. Et vous, qu'en pensez-vous ?",
            caption: 'CoursAvenue.com',
            description: "Retrouvez également des centaines d'autres établissements qui donnent des cours de loisirs ! Danse, théâtre, musique, cours insolite, j'en passe et des meilleurs !"
          };
      function callback(response) {
          document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
      }
      FB.ui(obj, callback);
      mixpanel.track('Share after comment', {type: 'Facebook'});
    }

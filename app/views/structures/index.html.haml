- @is_responsive = true

- if @subject
  - title = "#{@subject.name} à #{@city.name}"
- else
  - title = "Danse, Théâtre, Musique, Yoga... à #{@city.name || 'Paris'} "

= content_for :title do
  = "#{title} : #{number_with_delimiter @total.round(-2)} établissements avec #{number_with_delimiter @total_comments} avis | CoursAvenue"

= content_for :meta_description do
  #{title} : profitez des cours d'essai gratuits, consultez #{number_with_delimiter @total_comments} avis d'élèves, #{number_with_delimiter @total_medias} photos et vidéos, les meilleures professeurs sur CoursAvenue

- if robot?(request.env['HTTP_USER_AGENT'])
  = render partial: 'google_more_infos', locals: { title: title }

.filtered-search{ :data => { :type => "#{ @app_slug }-root" }, id: "#{ @app_slug }"}

:javascript
  window.coursavenue  = window.coursavenue || {};
  var subjects        = #{ ActiveModel::ArraySerializer.new(Subject.stars, each_serializer: SubjectSerializer).to_json };
  // Adding other subject to the collection because it's a fake object
  subjects.push( { name: 'Autres', slug: 'other' } );

  window.coursavenue.bootstrap = {
      current_pro_admin: #{(current_pro_admin ? true : false)},
      options: {
          total: #{ @total },
          latlng: #{ @latlng },
          server_api: {}
      },
      models: #{ @models.to_json },
      subjects: subjects,
      discount_types: #{ Price::Discount::TYPES.to_json }
  };

- if params[:root_subject_id] != params[:subject_id]
  :javascript
    window.coursavenue.bootstrap.options.server_api.subject_id = "#{ params[:subject_id] }";
- if @subject and @subject.depth == 2
  :javascript
    window.coursavenue.bootstrap.options.server_api.parent_subject_id = "#{ @subject.parent.slug }";
- if params[:root_subject_id].present?
  :javascript
    window.coursavenue.bootstrap.options.server_api.root_subject_id = "#{ params[:root_subject_id] }";

- content_for :scripts do
  - if Rails.env.production?
    :javascript
      ga('send', 'event', 'search', 'view');

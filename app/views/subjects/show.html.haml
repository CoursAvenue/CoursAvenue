= content_for :title do
  Tous les cours de #{@subject.name.downcase} | CoursAvenue

= content_for :above_container do
  - if @subject.image.present?
    .home-screen.bg-cover{style: "background-image: url(#{@subject.image.url})"}
      %h1.push--bottom.text--center.home-screen-title{style: 'padding-top: 3em;'}
        Tous les cours de <strong>#{@subject.name.downcase}</strong>
      - if @subject.title
        %h4.center-block.text--center.home-screen-title{style: 'width: 1000px'}
          = @subject.title
  - else
    #map.google-map.google-map--medium-small

  .white-box--noshadow
    .main-container.push--ends
      .grid
        .grid__item.one-sixth.text--center.delta>
          %div.soft-half--bottom Profils
          .bold= @structures_count
        .grid__item.one-sixth.text--center.delta>
          %div.soft-half--bottom Séances
          .bold= @plannings_count
        .grid__item.one-sixth.text--center.delta>
          %div.soft-half--bottom Lieux
          .bold= @places_count
        .grid__item.one-sixth.text--center.delta>
          %div.soft-half--bottom Cours d'essai gratuits
          .bold= @free_trial_course_count
        .grid__item.one-sixth.text--center.delta>
          %div.soft-half--bottom Photos & vidéos
          .bold= @medias_count
        .grid__item.one-sixth.text--center.delta>
          %div.soft-half--bottom Avis d'élèves
          .bold= @comments_count

- if @subject.subtitle
  %h2.text--center= @subject.subtitle || @subject.name

- if @subject.description
  .white-box.island= simple_format @subject.description

- if @subject.depth > 0 and @videos and @videos.any?
  %h3.text--center Sélection des vidéos de cours de <strong>#{@subject.name.downcase}</strong>
  .media-gallery.white-box>
    = render partial: 'medias/media', collection: @videos, locals: { width_class_name: 'one-fifth v-top text--center', vertical: true}
%hr

= render partial: 'subjects/subjects_facets'

%h3.text--center Sélection des profils de <strong>#{@subject.name.downcase}</strong>

.text--center.push--bottom
  = link_to structures_path(name: @subject.name), class: 'btn btn--green btn--large' do
    Voir tous les cours de
    %strong= @subject.name


.grid.push--bottom
  .grid__item.three-fifths>
    #structures-map.google-map.google-map--large
  .grid__item.two-fifths>
    - @structures[0..5].each do |structure|
      - comment = structure.comments.where{(title != nil) & (title != '')}.first
      - if comment
        = render partial: 'structures/structure_with_comment', locals: {structure: structure, comment: comment}
    = link_to 'Voir les autres profils', subject_structures_path(@subject, address_name: 'Paris'), class: 'btn btn--full btn--large', target: '_blank'




= render partial: 'subjects/comments', locals: { comments: @comments }

= render partial: 'subjects/images', locals: { comments: @images }

.text--center.push--bottom
  = link_to structures_path(name: @subject.name), class: 'btn btn--green btn--large' do
    Voir tous les cours de
    %strong= @subject.name

%hr

= render partial: 'subjects/courses', locals: { courses: @courses }

- unless @subject.image.present?
  = content_for :scripts do
    :javascript
      $(function() {
          handler = Gmaps.build('Google');
          handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
              markers = handler.addMarkers([#{@france_center_lat}, #{@france_center_lng}]);
              handler.bounds.extendWith(markers);
              handler.fitMapToBounds();
          });
          google.maps.event.addListener(handler.getMap(), 'tilesloaded', function() {
              handler.getMap().setZoom(12);
          });
      });

= content_for :scripts do
  :javascript
    $(function() {
        handler = Gmaps.build('Google');
        handler.buildMap({ provider: {}, internal: {id: 'structures-map'}}, function(){
            markers = handler.addMarkers(#{@json_structure_addresses.to_json});
            handler.bounds.extendWith(markers);
            handler.fitMapToBounds();
        });
    });

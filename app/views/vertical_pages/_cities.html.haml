- paris     = City.find 'paris'
- marseille = City.find 'marseille'
- lyon      = City.find 'lyon'
- toulouse  = City.find 'toulouse'
- nice      = City.find 'nice'
- nantes    = City.find 'nantes'
- bordeaux  = City.find 'bordeaux'
- lille     = City.find 'lille'
- cities = [paris, marseille, lyon, toulouse, nice, nantes, bordeaux, lille]

.main-container.main-container--medium
  %h2.soft--bottom.f-weight-300 Trouvez un cours près de chez vous
  - cities.each do |city|
    .inline-block.one-quarter.very-soft.hard--bottom>
      .relative.bg-cover{style: "background-image: url('#{city.image.url(:small)}'); height: 150px; "}>
        - if @subject.depth == 0
          - url = structures_path(lat: city.latitude, lng: city.longitude, address_name: city.name, root_subject_id: @subject.root.slug)
        - elsif @subject.depth == 1
          - url = structures_path(lat: city.latitude, lng: city.longitude, address_name: city.name, root_subject_id: @subject.root.slug, parent_subject_id: @subject.slug)
        - else
          - url = structures_path(lat: city.latitude, lng: city.longitude, address_name: city.name, root_subject_id: @subject.root.slug, parent_subject_id: @subject.parent.slug, subject_id: @subject.slug)
        = link_to url, class: 'block show-on-hover__wrapper', title: "Tous les cours de #{@subject.name} à #{city.name}" do
          .home-screen-gallery__title.text--center
            %div= city.name
            .show-on-hover__child.milli
              = StructureSearch.search({ lat: city.latitude, lng: city.longitude }).total
              profils

  = form_tag structures_path, method: :get, authenticity_token: false do
    .flexbox.very-soft
      %h4.flexbox__item.soft-half--right.one-third.nowrap.v-middle.flush.f-weight-300 Vous recherchez un cours dans une autre ville ?
      %input{ type: 'hidden', name: 'root_subject_id', value: @subject.root.slug }
      - if @subject.depth == 1
        %input{ type: 'hidden', name: 'parent_subject_id', value: @subject.slug }
      - elsif @subject.depth == 2
        %input{ type: 'hidden', name: 'parent_subject_id', value: @subject.parent.slug }
        %input{ type: 'hidden', name: 'subject_id', value: @subject.slug }
      .flexbox__item.soft-half--right
        .input-with-icon.v-middle
          %input.one-whole.input--large#address-picker.soft-half--left{ size: 25, placeholder:'Ville / CP / Adresse', type:'text', autocomplete: 'off', name:'address_name', data: {behavior:'address-picker', lng:'#address-lng',lat: '#address-lat', city: '#address-city' } }
          %i.fa.fa-map-marker.delta
        %input#address-lat{type: 'hidden', value: '48.8592', name: 'lat'}
        %input#address-lng{type: 'hidden', value: '2.3417', name: 'lng'}
        %input#address-city{type: 'hidden', value: 'Paris', name: 'address_name'}

      %button.flexbox__item.v-middle.nowrap.btn.btn--blue.btn--full.input--large{type: 'submit', id: 'submit_search_form'}
        %i.fa.fa-search
        Trouver

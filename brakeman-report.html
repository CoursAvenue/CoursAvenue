<!DOCTYPE HTML SYSTEM>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Brakeman Report</title>
  <script>
    function toggle(context) {
      var elem = document.getElementById(context);

      if (elem.style.display != "block")
        elem.style.display = "block";
      else
        elem.style.display = "none";

      elem.parentNode.scrollIntoView();
    }
  </script>
  <style>
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

a {
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

 .user_input {
   background-color: #fcecab;
 }

 div.render_path {
   display: none;
   background-color: #ffe;
   padding: 5px;
   margin: 2px 0px 2px 0px;
 }

 div.template_name {
   cursor: pointer;
 }

 div.template_name:hover {
   background-color: white;
 }

  </style>
</head>
<body>

<h1>Brakeman Report</h1>
<table>
  <tr>
    <th>Application Path</th>
    <th>Rails Version</th>
    <th>Brakeman Version</th>
    <th>Report Time</th>
    <th>Checks Performed</th>
  </tr>
  <tr>
    <td>/Users/Nima/Development/Work/CoursAvenue</td>
    <td>4.0.2</td>
    <td>2.3.1
    <td>
      2014-02-09 10:08:24 +0100<br><br>
      26.584896 seconds
    </td>
    <td>BasicAuth, ContentTag, CrossSiteScripting, DefaultRoutes, Deserialize, DetailedExceptions, DigestDoS, EscapeFunction, Evaluation, Execute, FileAccess, FilterSkipping, ForgerySetting, HeaderDoS, I18nXSS, JRubyXML, JSONParsing, LinkTo, LinkToHref, MailTo, MassAssignment, ModelAttrAccessible, ModelAttributes, ModelSerialize, NestedAttributes, NumberToCurrency, QuoteTableName, Redirect, Render, ResponseSplitting, SQL, SafeBufferManipulation, SanitizeMethods, SelectTag, SelectVulnerability, Send, SendFile, SessionSettings, SimpleFormat, SingleQuotes, SkipBeforeFilter, StripTags, SymbolDoS, TranslateBug, UnsafeReflection, ValidationRegex, WithoutProtection, YAMLParsing</td>
  </tr>
</table>
<br>
<h2 id='summary'>Summary</h2>
<table>
  <tr>
    <th>Scanned/Reported</th>
    <th>Total</th>
  </tr>
  <tr>
    <td>Controllers</td>
    <td>79</td>
  </tr>
  <tr>
    <td>Models</td>
    <td>54</td>
  </tr>
  <tr>
    <td>Templates</td>
    <td>304</td>
  </tr>
  <tr>
    <td>Errors</td>
    <td>0</td>
  </tr>
  <tr>
    <td>Security Warnings</td>
    <td>53 <span class='high-confidence'>(4)</span></td>
  </tr>
  
  <tr>
    <td>Ignored Warnings</td>
    <td>0</td>
  </tr>
  
</table>
<br>
<table>
  <tr>
    <th>Warning Type</th>
    <th>Total</th>
  </tr>
  
  <tr>
    <td>Cross Site Scripting</td>
    <td>17</td>
  </tr>
  
  <tr>
    <td>Mass Assignment</td>
    <td>32</td>
  </tr>
  
  <tr>
    <td>Remote Code Execution</td>
    <td>2</td>
  </tr>
  
  <tr>
    <td>Session Setting</td>
    <td>2</td>
  </tr>
  
</table>
<br>
<h2>Security Warnings</h2>  
<table>
  <tr>
    <th>Confidence</th>
    <th>Class</th>
    <th>Method</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CommentsController</td>
    <td>find_commentable</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
    <td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" ><span id='message3' style='display:block' >Unsafe reflection method constantize called with parameter value near line 51: params[:comment][:comm...</span><span id='full_message3' style='display:none'>Unsafe reflection method constantize called with parameter value near line 51: <span class="user_input">params[:comment][:commentable_type].classify</span>.constantize</span><table id='context3' class='context' style='display:none'><caption>app/controllers/comments_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>46</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def find_commentable</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    type = params[:comment][:commentable_type]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;Unknown commentable type&quot; unless %w(Structure).include?(type)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    type.classify.constantize.find(params[:comment][:commentable_id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ReservationsController</td>
    <td>find_reservable</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
    <td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" ><span id='message4' style='display:block' >Unsafe reflection method constantize called with parameter value near line 30: params[:reservation][:...</span><span id='full_message4' style='display:none'>Unsafe reflection method constantize called with parameter value near line 30: <span class="user_input">params[:reservation][:reservable_type].classify</span>.constantize</span><table id='context4' class='context' style='display:none'><caption>app/controllers/reservations_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>25</pre>
          </td>
          <td class='context'>
            <pre class='context'>  private</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>  private</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def find_reservable</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>    type = params[:reservation][:reservable_type]</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>    type.classify.constantize.find(params[:reservation][:reservable_id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td></td>
    <td></td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/session_setting/">Session Setting</a></td>
    <td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" >Session secret should not be included in version control near line 7<table id='context1' class='context' style='display:none'><caption>config/initializers/secret_token.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'># Your secret key for verifying the integrity of signed cookies.</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'># If you change this key, all old signed cookies will become invalid!</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'># Make sure the secret is at least 30 characters and all random,</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'># no regular words or you&#39;ll be exposed to dictionary attacks.</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>CoursAvenue::Application.config.secret_token = &#39;419a7650a34d1a85f19261aff764166654e789f07a2305cbe849ef1402a8a5e9324a5b57ab9947dfb0350e0c314cfc7dfc2ee99cfc162300cc3997a58958ce6f&#39;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>CoursAvenue::Application.config.secret_key_base = &#39;519a7650a34d1a85f19261aff764166654e789f07a2305cbe849ef1402a8a5e9324a5b57ab9947dfb0350e0c314cfc7dfc2ee99cfc162300cc3997a58958ce6f&#39;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td></td>
    <td></td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/session_setting/">Session Setting</a></td>
    <td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" >Session secret should not be included in version control near line 8<table id='context2' class='context' style='display:none'><caption>config/initializers/secret_token.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'># Your secret key for verifying the integrity of signed cookies.</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'># If you change this key, all old signed cookies will become invalid!</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'># Make sure the secret is at least 30 characters and all random,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'># no regular words or you&#39;ll be exposed to dictionary attacks.</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>CoursAvenue::Application.config.secret_token = &#39;419a7650a34d1a85f19261aff764166654e789f07a2305cbe849ef1402a8a5e9324a5b57ab9947dfb0350e0c314cfc7dfc2ee99cfc162300cc3997a58958ce6f&#39;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>CoursAvenue::Application.config.secret_key_base = &#39;519a7650a34d1a85f19261aff764166654e789f07a2305cbe849ef1402a8a5e9324a5b57ab9947dfb0350e0c314cfc7dfc2ee99cfc162300cc3997a58958ce6f&#39;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
</table>
<p>Model Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Model</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>::Admin</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;structure_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>::Teacher</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;structure_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>CitySubjectInfo</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;city_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>CitySubjectInfo</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;subject_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>ClickLog</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;structure_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Comment</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;commentable_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Comment</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;subject_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Course</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;subject_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Course</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;level_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Course</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;audience_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Course</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;place_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>InvitedUser</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;referrer_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Location</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;city_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Media</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;mediable_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Media</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;provider_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Media</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;subject_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Passion</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;expectation_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Passion</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;reason_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Passion</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;subject_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Passion</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;parent_subject_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Planning</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;teacher_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Planning</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;level_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Planning</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;audience_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Planning</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;place_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Reservation</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;reservable_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Structure</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;city_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Structure</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;place_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Structure</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;subject_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Structure</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;funding_type_ids&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>User</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;city_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UserProfile</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;structure_id&#39; available for mass assignment</td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UserProfileImport</td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td>Potentially dangerous attribute &#39;structure_id&#39; available for mass assignment</td>
  </tr>

</table><p>View Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Template</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        pro/subjects/edit (Pro::SubjectsController#edit)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context16');toggle('message16');toggle('full_message16')" ><span id='message16' style='display:block' >Unsafe model attribute in link_to href near line 8: link_to(&quot;Voir la page&quot;, vertical_page_url_for(Sub...</span><span id='full_message16' style='display:none'>Unsafe model attribute in link_to href near line 8: link_to(&quot;Voir la page&quot;, vertical_page_url_for(<span class="user_input">Subject.friendly</span>.find(params[:id])), :target =&gt; :_blank)</span><table id='context16' class='context' style='display:none'><caption>app/views/pro/subjects/edit.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>- if @subject.image.present?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = image_tag @subject.image.url, height: 100</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>%div</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %h3.inline-block= @subject.name</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  .inline-block= link_to &#39;Voir la page&#39;, vertical_page_url_for(@subject), target: :_blank</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>.form-white-box</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = simple_form_for [:pro, @subject], remote: true do |f|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = f.input :image</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = f.input :title</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = f.input :subtitle</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        pro/subjects/edit (Pro::SubjectsController#edit)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context17');toggle('message17');toggle('full_message17')" ><span id='message17' style='display:block' >Unsafe model attribute in link_to href near line 21: link_to(&quot;Voir la page&quot;, vertical_page_url_for(Su...</span><span id='full_message17' style='display:none'>Unsafe model attribute in link_to href near line 21: link_to(&quot;Voir la page&quot;, vertical_page_url_for(<span class="user_input">Subject.friendly</span>.find(params[:id]), City.find(&quot;paris&quot;)), :target =&gt; :_blank)</span><table id='context17' class='context' style='display:none'><caption>app/views/pro/subjects/edit.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>16</pre>
          </td>
          <td class='context'>
            <pre class='context'>    = f.input :tips, input_html: { data: { behavior: &#39;autoresize&#39;} }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = f.submit &#39;Enregistrer&#39;, class: &#39;btn btn--full btn--green&#39;, disable_with: &quot;En train d&#39;enregistrer&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>%div</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %h3.inline-block= &quot;#{@city.name} / #{@subject.name}&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>  .inline-block= link_to &#39;Voir la page&#39;, vertical_page_url_for(@subject, @city), target: :_blank</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>.form-white-box</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = simple_form_for @city_subject_info, url: pro_city_subject_infos_path, method: :post, remote: true do |f|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = f.input :subject_id , as: :hidden</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>    = f.input :city_id , as: :hidden</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        pro/subjects/index (Pro::SubjectsController#index)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context18');toggle('message18');toggle('full_message18')" ><span id='message18' style='display:block' >Unsafe model attribute in link_to href near line 46: link_to(&quot;Lien&quot;, vertical_page_url_for(Subject.fi...</span><span id='full_message18' style='display:none'>Unsafe model attribute in link_to href near line 46: link_to(&quot;Lien&quot;, vertical_page_url_for(<span class="user_input">Subject.find((local facet).value)</span>), :target =&gt; :_blank)</span><table id='context18' class='context' style='display:none'><caption>app/views/pro/subjects/index.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>41</pre>
          </td>
          <td class='context'>
            <pre class='context'>            - city_subject_info = CitySubjectInfo.load(@paris.id, subject.id)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>            - if city_subject_info and city_subject_info.where_to_practice.present?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>              %i.fa.fa-check</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>            Paris</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        %td.nowrap</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>          = link_to &#39;Lien&#39;, vertical_page_url_for(subject), target: :_blank</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>          \/</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>          = link_to &#39;Lien Paris&#39;, vertical_page_url_for(subject, @paris), target: :_blank</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>%h2 Disciplines niveau 2</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>%table.table--data.table--striped.white-box#dataTable{style: &#39;margin-bottom: 1000px;&#39;}</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        pro/subjects/index (Pro::SubjectsController#index)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context19');toggle('message19');toggle('full_message19')" ><span id='message19' style='display:block' >Unsafe model attribute in link_to href near line 48: link_to(&quot;Lien Paris&quot;, vertical_page_url_for(Subj...</span><span id='full_message19' style='display:none'>Unsafe model attribute in link_to href near line 48: link_to(&quot;Lien Paris&quot;, vertical_page_url_for(<span class="user_input">Subject.find((local facet).value)</span>, City.find(&quot;paris&quot;)), :target =&gt; :_blank)</span><table id='context19' class='context' style='display:none'><caption>app/views/pro/subjects/index.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>43</pre>
          </td>
          <td class='context'>
            <pre class='context'>              %i.fa.fa-check</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>            Paris</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        %td.nowrap</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>          = link_to &#39;Lien&#39;, vertical_page_url_for(subject), target: :_blank</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>          \/</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>          = link_to &#39;Lien Paris&#39;, vertical_page_url_for(subject, @paris), target: :_blank</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>%h2 Disciplines niveau 2</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>%table.table--data.table--striped.white-box#dataTable{style: &#39;margin-bottom: 1000px;&#39;}</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>  %thead</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    %tr</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        <div class="template_name" onClick="toggle('callers4')" >
          <div>
            shared/_footer (Template:layouts/users)
          </div>
          <div class="render_path" id="callers4" >
            ::Pro::AdminsController#edit &rarr; Template:layouts/users &rarr; shared/_footer
          </div>
        </div>
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context20');toggle('message20');toggle('full_message20')" ><span id='message20' style='display:block' >Unsafe parameter value in link_to href near line 58: link_to(&quot;Cours de #{(local subject).name} à #{::...</span><span id='full_message20' style='display:none'>Unsafe parameter value in link_to href near line 58: link_to(&quot;Cours de #{(local subject).name} à #{::Admin.find(<span class="user_input">params</span>[:id]).structure.city.name}&quot;, vertical_page_url_for((local subject), ::Admin.find(<span class="user_input">params</span>[:id]).structure.city), :class =&gt; &quot;semi-muted-link&quot;, :target =&gt; :_blank)</span><table id='context20' class='context' style='display:none'><caption>app/views/shared/_footer.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>53</pre>
          </td>
          <td class='context'>
            <pre class='context'>    .main-container.text--center</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = link_to &quot;Tous les cours à #{@structure.city.name}&quot;, city_url(@structure.city, subdomain: &#39;www&#39;), class: &#39;semi-muted-link&#39;, target: :_blank</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>      - @structure.subjects.uniq.each_with_index do |subject, index|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>        - if index &gt; 0</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>          ,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        = link_to &quot;Cours de #{subject.name} à #{@structure.city.name}&quot;, vertical_page_url_for(subject, @structure.city), class: &#39;semi-muted-link&#39;, target: :_blank</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        subjects/cities/medias/videos (Subjects::Cities::MediasController#videos)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context21');toggle('message21');toggle('full_message21')" ><span id='message21' style='display:block' >Unsafe model attribute in link_to href near line 8: link_to(&quot;Retour \u{e0} la liste des \u{e9}tabliss...</span><span id='full_message21' style='display:none'>Unsafe model attribute in link_to href near line 8: link_to(&quot;Retour \u{e0} la liste des \u{e9}tablissements&quot;, vertical_page_url_for(<span class="user_input">Subject.friendly</span>.find(params[:subject_id]).root, City.friendly.find(params[:city_id])))</span><table id='context21' class='context' style='display:none'><caption>app/views/subjects/cities/medias/videos.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>= content_for :above_container do</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  #medias.soft--bottom</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    .text--center.push</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>      %h2.flush= &quot;Toutes les vidéos de #{@subject.name.downcase} à #{@city.name}&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>      = link_to &#39;Retour à la liste des établissements&#39;, vertical_page_url_for(@subject.root, @city)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    .text--center.push--bottom= paginate @videos, window: 1, outer_window: 3</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    .media-gallery.js-masonry{&#39;data-masonry-options&#39; =&gt; &#39;{ &quot;itemSelector&quot;: &quot;.media__item&quot; }&#39;}</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      - @videos.each do |media|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>        .one-quarter.media__item.very-soft{style: &#39;max-width: 450px&#39;}&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>          %a.break-all.flush--bottom.white-box.islet{href: media.url, title: media.caption, data: {behavior: &#39;fancy&#39;}}</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        courses/index (CoursesController#index)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context5');toggle('message5');toggle('full_message5')" ><span id='message5' style='display:block' >Unescaped parameter value near line 68: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message5' style='display:none'>Unescaped parameter value near line 68: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;  $(function() {       $(&#39;body&#39;).stickem();       $(&#39;.filter-select&#39;).click(function() {           $(&#39;#hidden-sort-input&#39;).val(this.dataset.value);           $(&#39;#submit_search_form&#39;).click();       });       $(&#39;[data-type=course-element]&#39;).each(function(index, el) {           $(this).click(function(event) {               // Change url only if user doesn&#39;t click on link               if (event.target.nodeName !== &#39;A&#39;) {                   if (event.metaKey || event.ctrlKey) {                       window.open($(this).data(&#39;url&#39;));                   } else {                       window.location = $(this).data(&#39;url&#39;);                   }                   return false;               }           });       });       google.maps.event.addDomListener(window, &#39;load&#39;, function() {           Gmaps.map.addMarkers([{             id: -1,             lat: #{<span class="user_input">params[:lat]</span>},             lng: #{params[:lng]}           }]);       });   }); &quot;, _hamlout.options))</span><table id='context5' class='context' style='display:none'><caption>app/views/courses/index.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>63</pre>
          </td>
          <td class='context'>
            <pre class='context'>      %footer.g.one-whole</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        = paginate @courses, window: 2, outer_window: 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>= content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>  :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>          $(&#39;body&#39;).stickem();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>          $(&#39;.filter-select&#39;).click(function() {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>              $(&#39;#hidden-sort-input&#39;).val(this.dataset.value);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>              $(&#39;#submit_search_form&#39;).click();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>          });</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        pro/admins/index (::Pro::AdminsController#index)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context6');toggle('message6');toggle('full_message6')" ><span id='message6' style='display:block' >Unescaped parameter value near line 80: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message6' style='display:none'>Unescaped parameter value near line 80: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {     $(&#39;#dataTable&#39;).tablesorter();     // Admin search     var template = Handlebars.compile($(&#39;#structure-item-template&#39;).html());     $(&#39;#search-input&#39;).typeahead([       {         valueKey: &#39;name&#39;,         template: template,         limit: 10,         remote: {           url: &#39;/admins.json?name=%QUERY&#39;         }       }     ]);     $(&#39;#search-input&#39;).on(&#39;typeahead:selected&#39;, function(event, data){         window.open(&#39;/etablissements/&#39; + data.structure.slug)     });     $(&#39;#sorting&#39;).change(function(){         var new_location = &quot;#{pro_admins_path}&quot; + &#39;?page=&#39;;         new_location += &#39;#{(<span class="user_input">params[:page]</span> or 1)}&#39;;         new_location += &#39;&amp;sort=&#39; + this.value;         window.location = new_location;     }); }) &quot;, _hamlout.options))</span><table id='context6' class='context' style='display:none'><caption>app/views/pro/admins/index.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>75</pre>
          </td>
          <td class='context'>
            <pre class='context'>    %strong {{structure.name}}</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ({{structure.comments_count}} avis)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>= content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>  :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>    $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        $(&#39;#dataTable&#39;).tablesorter();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>        // Admin search</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>        var template = Handlebars.compile($(&#39;#structure-item-template&#39;).html());</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        $(&#39;#search-input&#39;).typeahead([</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>          {</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        pro/click_logs/index (Pro::ClickLogsController#index)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context7');toggle('message7');toggle('full_message7')" ><span id='message7' style='display:block' >Unescaped model attribute near line 25: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message7' style='display:none'>Unescaped model attribute near line 25: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {     $(&#39;#dataTable&#39;).tablesorter();     new Highcharts.Chart({         chart: { renderTo: &#39;click_logs&#39;, type: &#39;column&#39; },         title: { text: null },         xAxis: { categories: #{<span class="user_input">ClickLog.count(:order =&gt; &quot;DATE(created_at) ASC&quot;, :group =&gt; ([&quot;DATE(created_at)&quot;])).map</span> do  l(Date.parse((local date).to_s), :format =&gt; :short)  end} },         yAxis: { title: { text: &#39;&#39;}},         series: [           { data: #{<span class="user_input">ClickLog.count(:order =&gt; &quot;DATE(created_at) ASC&quot;, :group =&gt; ([&quot;DATE(created_at)&quot;])).map</span> do  (local count)  end},             name: &#39;Profs inscrits&#39;            }         ]     }); }); &quot;, _hamlout.options))</span><table id='context7' class='context' style='display:none'><caption>app/views/pro/click_logs/index.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>20</pre>
          </td>
          <td class='context'>
            <pre class='context'>        %td= structure.comments_count</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>        %td= count</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>= content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>  :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>    $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>        $(&#39;#dataTable&#39;).tablesorter();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>        new Highcharts.Chart({</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>            chart: { renderTo: &#39;click_logs&#39;, type: &#39;column&#39; },</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>            title: { text: null },</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>            xAxis: { categories: #{@click_logs_per_day.map{|date, count| l(Date.parse(date.to_s), format: :short)}} },</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        pro/dashboard/index (Pro::DashboardController#index)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context8');toggle('message8');toggle('full_message8')" ><span id='message8' style='display:block' >Unescaped model attribute near line 254: find_and_preserve(Haml::Filters::Javascript.render_with_opti...</span><span id='full_message8' style='display:none'>Unescaped model attribute near line 254: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {   new Highcharts.Chart({       chart: { renderTo: &#39;subjects&#39;, type: &#39;column&#39; },       title: { text: null },       xAxis: { categories: #{{ <span class="user_input">Subject.friendly.find((local key))</span>.grand_parent.name =&gt; ((({}[<span class="user_input">Subject.friendly.find((local key))</span>.grand_parent.name] or 0) + (local value))), <span class="user_input">Subject.friendly.find((local key))</span>.name =&gt; ((local value)) }.map do  (local subject_name)  end} },       yAxis: { title: { text: &#39;&#39;}},       series: [{ data: #{{ <span class="user_input">Subject.friendly.find((local key))</span>.grand_parent.name =&gt; ((({}[<span class="user_input">Subject.friendly.find((local key))</span>.grand_parent.name] or 0) + (local value))), <span class="user_input">Subject.friendly.find((local key))</span>.name =&gt; ((local value)) }.map do  (local count)  end} }]   }); &quot;, _hamlout.options))</span><table id='context8' class='context' style='display:none'><caption>app/views/pro/dashboard/index.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>249</pre>
          </td>
          <td class='context'>
            <pre class='context'>    });</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>251</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if params[:with_subjects].present?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>252</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>253</pre>
            </td>
            <td class='context'>
              <pre class='context'>    :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>254</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>255</pre>
            </td>
            <td class='context'>
              <pre class='context'>        new Highcharts.Chart({</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>256</pre>
            </td>
            <td class='context'>
              <pre class='context'>            chart: { renderTo: &#39;subjects&#39;, type: &#39;column&#39; },</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>257</pre>
            </td>
            <td class='context'>
              <pre class='context'>            title: { text: null },</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>258</pre>
            </td>
            <td class='context'>
              <pre class='context'>            xAxis: { categories: #{@structures.map{|subject_name, count| subject_name}} },</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>259</pre>
            </td>
            <td class='context'>
              <pre class='context'>            yAxis: { title: { text: &#39;&#39;}},</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        pro/structures/crop_logo (Pro::StructuresController#crop_logo)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context9');toggle('message9');toggle('full_message9')" ><span id='message9' style='display:block' >Unescaped model attribute near line 31: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message9' style='display:none'>Unescaped model attribute near line 31: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {   var update_crop;   update_crop = function(coords) {       $(&#39;#preview&#39;).css({           width: Math.round(150 / coords.w * $(&#39;#cropbox&#39;).width()) + &#39;px&#39;,           height: Math.round(150 / coords.w * $(&#39;#cropbox&#39;).height()) + &#39;px&#39;,           marginLeft: &#39;-&#39; + Math.round(150 / coords.w * coords.x) + &#39;px&#39;,           marginTop: &#39;-&#39; + Math.round(150 / coords.h * coords.y) + &#39;px&#39;       });       $(&quot;#crop_x&quot;).val(Math.round(coords.x * #{<span class="user_input">Structure.find(params[:id]).ratio_from_original_from_large</span>}));       $(&quot;#crop_y&quot;).val(Math.round(coords.y * #{<span class="user_input">Structure.find(params[:id]).ratio_from_original_from_large</span>}));       $(&quot;#crop_width&quot;).val(Math.round(coords.w * #{<span class="user_input">Structure.find(params[:id]).ratio_from_original_from_large</span>}));       $(&quot;#crop_height&quot;).val(Math.round(coords.w * #{<span class="user_input">Structure.find(params[:id]).ratio_from_original_from_large</span>}));   }   var crop_x      = #{(Structure.find(params[:id]).crop_x or 0)};   var crop_y      = #{(Structure.find(params[:id]).crop_y or 0)};   var crop_width  = #{(Structure.find(params[:id]).crop_width or 200)};   var ratio       =  #{<span class="user_input">Structure.find(params[:id]).ratio_from_original_from_large</span>};   $(&#39;#cropbox&#39;).Jcrop({       aspectRatio: 1,       setSelect: [(crop_x / ratio), (crop_y / ratio), (crop_x + crop_width) / ratio, (crop_y + crop_width) / ratio],       onChange: update_crop,       onSelect: update_crop   }); }); &quot;, _hamlout.options))</span><table id='context9' class='context' style='display:none'><caption>app/views/pro/structures/crop_logo.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>- @ratio = @structure.ratio_from_original_from_large</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>= content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>  :javascript</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>    $(function() {</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var update_crop;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      update_crop = function(coords) {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>          $(&#39;#preview&#39;).css({</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>              width: Math.round(150 / coords.w * $(&#39;#cropbox&#39;).width()) + &#39;px&#39;,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>              height: Math.round(150 / coords.w * $(&#39;#cropbox&#39;).height()) + &#39;px&#39;,</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        pro/structures/user_profiles/index (Pro::Structures::UserProfilesController#index)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context10');toggle('message10');toggle('full_message10')" ><span id='message10' style='display:block' >Unescaped parameter value near line 14: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message10' style='display:none'>Unescaped parameter value near line 14: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;window.coursavenue = window.coursavenue || {}; var models = #{ActiveModel::ArraySerializer.new(UserProfileSearch.search(<span class="user_input">params</span>).results, :each_serializer =&gt; (UserProfileSerializer)).to_json}; window.coursavenue.bootstrap = {   options: {     total: #{UserProfileSearch.search(<span class="user_input">params</span>).total}   },   models: models }; &quot;, _hamlout.options))</span><table id='context10' class='context' style='display:none'><caption>app/views/pro/structures/user_profiles/index.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>10</pre>
          </td>
          <td class='context'>
            <pre class='context'>.text--center</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = link_to &#39;Ajouter un élève&#39;, new_pro_structure_user_profile_path(@structure), class: &#39;btn btn--blue&#39;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>:javascript</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>  window.coursavenue = window.coursavenue || {};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var models = #{ActiveModel::ArraySerializer.new(@user_profiles, each_serializer: UserProfileSerializer).to_json};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>  window.coursavenue.bootstrap = {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    options: {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>      total: #{ @user_profiles_search.total }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>    },</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        structures/comments/new (CommentsController#create)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context11');toggle('message11');toggle('full_message11')" ><span id='message11' style='display:block' >Unescaped parameter value near line 26: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message11' style='display:none'>Unescaped parameter value near line 26: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {   if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire j+&#39;, &#39;vue&#39;, &#39;#{<span class="user_input">params[:stage]</span>}&#39;]);} }); &quot;, _hamlout.options))</span><table id='context11' class='context' style='display:none'><caption>app/views/structures/comments/new.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>21</pre>
          </td>
          <td class='context'>
            <pre class='context'>  = &quot;Merci d&#39;avance pour tous vos témoignages.&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if params.has_key? :stage</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>    :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire j+&#39;, &#39;vue&#39;, &#39;#{params[:stage]}&#39;]);}</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>      });</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>- else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>    :javascript</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        structures/comments/new (Structures::CommentsController#new)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context12');toggle('message12');toggle('full_message12')" ><span id='message12' style='display:block' >Unescaped model attribute near line 39: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message12' style='display:none'>Unescaped model attribute near line 39: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {   if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire depuis facebook&#39;, &#39;vue&#39;, &#39;#{<span class="user_input">Structure.friendly.find(params[:structure_id])</span>.name}&#39;]);} }); &quot;, _hamlout.options))</span><table id='context12' class='context' style='display:none'><caption>app/views/structures/comments/new.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>      });</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if params.has_key? :facebook</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>    :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire depuis facebook&#39;, &#39;vue&#39;, &#39;#{@structure.name}&#39;]);}</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>      });</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if params.has_key? :website</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        structures/comments/new (Structures::CommentsController#new)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context13');toggle('message13');toggle('full_message13')" ><span id='message13' style='display:block' >Unescaped model attribute near line 46: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message13' style='display:none'>Unescaped model attribute near line 46: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {   if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire depuis site perso&#39;, &#39;vue&#39;, &#39;#{<span class="user_input">Structure.friendly.find(params[:structure_id])</span>.name}&#39;]);} }); &quot;, _hamlout.options))</span><table id='context13' class='context' style='display:none'><caption>app/views/structures/comments/new.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>41</pre>
          </td>
          <td class='context'>
            <pre class='context'>      });</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if params.has_key? :website</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire depuis site perso&#39;, &#39;vue&#39;, &#39;#{@structure.name}&#39;]);}</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      });</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if params.has_key? :email</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        structures/comments/new (Structures::CommentsController#new)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context14');toggle('message14');toggle('full_message14')" ><span id='message14' style='display:block' >Unescaped model attribute near line 53: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message14' style='display:none'>Unescaped model attribute near line 53: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function() {   if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire depuis email perso&#39;, &#39;vue&#39;, &#39;#{<span class="user_input">Structure.friendly.find(params[:structure_id])</span>.name}&#39;]);} }); &quot;, _hamlout.options))</span><table id='context14' class='context' style='display:none'><caption>app/views/structures/comments/new.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>48</pre>
          </td>
          <td class='context'>
            <pre class='context'>      });</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if params.has_key? :email</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>  = content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>    :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(function() {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if(typeof _gaq !== &#39;undefined&#39;) {_gaq.push([&#39;_trackEvent&#39;, &#39;Commentaire depuis email perso&#39;, &#39;vue&#39;, &#39;#{@structure.name}&#39;]);}</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>      });</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>.grid</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>  .grid__item.two-thirds&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        users/conversations/show (Users::ConversationsController#show)
      
    </td>
    <td><a rel="no-referrer" href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context15');toggle('message15');toggle('full_message15')" ><span id='message15' style='display:block' >Unescaped parameter value near line 40: find_and_preserve(Haml::Filters::Javascript.render_with_optio...</span><span id='full_message15' style='display:none'>Unescaped parameter value near line 40: find_and_preserve(Haml::Filters::Javascript.render_with_options(&quot;$(function(){     if ($.cookie(&quot;conversation_#{<span class="user_input">params[:id]</span>}_message_first_time&quot;)) {         $.removeCookie(&quot;conversation_#{<span class="user_input">params[:id]</span>}_message&quot;, {path: &#39;/&#39;});     } else {         $.cookie(&quot;conversation_#{<span class="user_input">params[:id]</span>}_message_first_time&quot;, true);     } }); &quot;, _hamlout.options))</span><table id='context15' class='context' style='display:none'><caption>app/views/users/conversations/show.html.haml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>35</pre>
          </td>
          <td class='context'>
            <pre class='context'>          });</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>      });</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>- content_for :scripts do</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>  :javascript</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    $(function(){</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if ($.cookie(&quot;conversation_#{params[:id]}_message_first_time&quot;)) {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>            $.removeCookie(&quot;conversation_#{params[:id]}_message&quot;, {path: &#39;/&#39;});</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>        } else {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>            $.cookie(&quot;conversation_#{params[:id]}_message_first_time&quot;, true);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

</table>
</body></html>
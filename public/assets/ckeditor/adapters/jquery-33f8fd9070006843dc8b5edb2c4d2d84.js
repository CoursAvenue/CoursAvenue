!function(t){CKEDITOR.config.jqueryOverrideVal="undefined"==typeof CKEDITOR.config.jqueryOverrideVal?!0:CKEDITOR.config.jqueryOverrideVal,"undefined"!=typeof t&&(t.extend(t.fn,{ckeditorGet:function(){var t=this.eq(0).data("ckeditorInstance");if(!t)throw"CKEditor is not initialized yet, use ckeditor() with a callback.";return t},ckeditor:function(e,i){if(!CKEDITOR.env.isCompatible)throw Error("The environment is incompatible.");if(!t.isFunction(e))var n=i,i=e,e=n;var r=[],i=i||{};this.each(function(){var n=t(this),s=n.data("ckeditorInstance"),o=n.data("_ckeditorInstanceLock"),a=this,l=new t.Deferred;r.push(l.promise()),s&&!o?(e&&e.apply(s,[this]),l.resolve()):o?s.once("instanceReady",function(){setTimeout(function(){s.element?(s.element.$==a&&e&&e.apply(s,[a]),l.resolve()):setTimeout(arguments.callee,100)},0)},null,null,9999):((i.autoUpdateElement||"undefined"==typeof i.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)&&(i.autoUpdateElementJquery=!0),i.autoUpdateElement=!1,n.data("_ckeditorInstanceLock",!0),s=t(this).is("textarea")?CKEDITOR.replace(a,i):CKEDITOR.inline(a,i),n.data("ckeditorInstance",s),s.on("instanceReady",function(i){var r=i.editor;setTimeout(function(){if(r.element){if(i.removeListener(),r.on("dataReady",function(){n.trigger("dataReady.ckeditor",[r])}),r.on("setData",function(t){n.trigger("setData.ckeditor",[r,t.data])}),r.on("getData",function(t){n.trigger("getData.ckeditor",[r,t.data])},999),r.on("destroy",function(){n.trigger("destroy.ckeditor",[r])}),r.on("save",function(){return t(a.form).submit(),!1},null,null,20),r.config.autoUpdateElementJquery&&n.is("textarea")&&t(a.form).length){var s=function(){n.ckeditor(function(){r.updateElement()})};t(a.form).submit(s),t(a.form).bind("form-pre-serialize",s),n.bind("destroy.ckeditor",function(){t(a.form).unbind("submit",s),t(a.form).unbind("form-pre-serialize",s)})}r.on("destroy",function(){n.removeData("ckeditorInstance")}),n.removeData("_ckeditorInstanceLock"),n.trigger("instanceReady.ckeditor",[r]),e&&e.apply(r,[a]),l.resolve()}else setTimeout(arguments.callee,100)},0)},null,null,9999))});var s=new t.Deferred;return this.promise=s.promise(),t.when.apply(this,r).then(function(){s.resolve()}),this.editor=this.eq(0).data("ckeditorInstance"),this}}),CKEDITOR.config.jqueryOverrideVal&&(t.fn.val=CKEDITOR.tools.override(t.fn.val,function(e){return function(i){if(arguments.length){var n=this,r=[],s=this.each(function(){var n=t(this),s=n.data("ckeditorInstance");if(n.is("textarea")&&s){var o=new t.Deferred;return s.setData(i,function(){o.resolve()}),r.push(o.promise()),!0}return e.call(n,i)});if(r.length){var o=new t.Deferred;return t.when.apply(this,r).done(function(){o.resolveWith(n)}),o.promise()}return s}var s=t(this).eq(0),a=s.data("ckeditorInstance");return s.is("textarea")&&a?a.getData():e.call(s)}})))}(window.jQuery);
$.QueryString=function(t){if(""==t)return{};for(var e={},i=0;i<t.length;++i){var n=t[i].split("=");2==n.length&&(e[n[0]]=decodeURIComponent(n[1].replace(/\+/g," ")))}return e}(window.location.search.substr(1).split("&")),$(document).ready(function(){$("div.gal-item div.gal-inner-holder").live("mouseover",function(){$(this).addClass("hover")}).live("mouseout",function(){$(this).removeClass("hover")}).live("click",function(){var t=$(this).parents("div.gal-item").data("url");CKEDITOR.tools.callFunction(CKEditorFuncNum,t),window.close()}),$("div.gal-item a.gal-del").live("ajax:complete",function(){$(this).parents("div.gal-item").remove()});var t=$.endlessScroll({container:".fileupload-list",entity:".gal-item",scrollPadding:100});t.scrollModule.unbind(),window.setTimeout(function(){t.scrollModule.bind()},1e3)}),qq.FileUploader.instances=new Object,qq.FileUploaderInput=function(t){qq.FileUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,template_id:"#fileupload_tmpl",classes:{button:"fileupload-button",drop:"fileupload-drop-area",dropActive:"fileupload-drop-area-active",list:"fileupload-list",preview:"fileupload-preview",file:"fileupload-file",spinner:"fileupload-spinner",size:"fileupload-size",cancel:"fileupload-cancel",success:"fileupload-success",fail:"fileupload-fail"}}),qq.extend(this._options,t),this._element=document.getElementById(this._options.element),this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button=this._createUploadButton(this._find(this._element,"button")),qq.FileUploader.instances[this._element.id]=this},qq.extend(qq.FileUploaderInput.prototype,qq.FileUploaderBasic.prototype),qq.extend(qq.FileUploaderInput.prototype,{_find:function(t,e){var i=qq.getByClass(t,this._options.classes[e])[0];if(!i)throw alert(e),new Error("element not found "+e);return i},_setupDragDrop:function(){var t=this,e=this._find(this._element,"drop"),i=new qq.UploadDropZone({element:e,onEnter:function(i){qq.addClass(e,t._classes.dropActive),i.stopPropagation()},onLeave:function(t){t.stopPropagation()},onLeaveNotDescendants:function(){qq.removeClass(e,t._classes.dropActive)},onDrop:function(i){e.style.display="none",qq.removeClass(e,t._classes.dropActive),t._uploadFileList(i.dataTransfer.files)}});e.style.display="none",qq.attach(document,"dragenter",function(t){i._isValidFileDrag(t)&&(e.style.display="block")}),qq.attach(document,"dragleave",function(t){if(i._isValidFileDrag(t)){var n=document.elementFromPoint(t.clientX,t.clientY);n&&"HTML"!=n.nodeName||(e.style.display="none")}})},_onSubmit:function(t,e){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(t,e)},_onProgress:function(t,e,i,n){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var r,s=this._getItemByFileId(t),a=this._find(s,"size");r=i!=n?Math.round(i/n*100)+"% from "+this._formatSize(n):this._formatSize(n),qq.setText(a,r)},_onComplete:function(t,e,i){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var n=this._getItemByFileId(t),r=i.asset?i.asset:i;r&&r.id?(qq.addClass(n,this._classes.success),r.size=this._formatSize(r.size),r.controller="ckeditor::picture"==r.type.toLowerCase()?"pictures":"attachment_files",$(n).replaceWith($(this._options.template_id).tmpl(r))):qq.addClass(n,this._classes.fail)},_addToList:function(t,e){if(this._listElement){this._options.multiple===!1&&$(this._listElement).empty();var i={id:0,filename:this._formatFileName(e),size:0,format_created_at:"",url_content:"#",controller:"assets",url_thumb:"https://coursavenue-staging-assets.s3.amazonaws.com/assets/ckeditor/filebrowser/images/preloader-f0309593d1f8cf989dbe5e528191439a.gif"},n=$(this._options.template_id).tmpl(i).attr("qqfileid",t).prependTo(this._listElement);n.find("div.img").addClass("preloader"),this._bindCancelEvent(n)}},_getItemByFileId:function(t){return $(this._listElement).find("div[qqfileid="+t+"]").get(0)},_bindCancelEvent:function(t){var e=this,i=$(t);i.find("a."+this._classes.cancel).bind("click",function(t){return e._handler.cancel(i.attr("qqfileid")),i.remove(),qq.preventDefault(t),!1})}});